<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>周边生态 on Apache HoraeDB</title><link>https://horaedb.apache.org/cn/docs/user-guide/ecosystem/</link><description>Recent content in 周边生态 on Apache HoraeDB</description><generator>Hugo</generator><language>cn</language><atom:link href="https://horaedb.apache.org/cn/docs/user-guide/ecosystem/index.xml" rel="self" type="application/rss+xml"/><item><title>InfluxDB</title><link>https://horaedb.apache.org/cn/docs/user-guide/ecosystem/influxdb/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://horaedb.apache.org/cn/docs/user-guide/ecosystem/influxdb/</guid><description>&lt;p>&lt;a href="https://www.influxdata.com/products/influxdb-overview/">InfluxDB&lt;/a> 是一个时间序列数据库，旨在处理高写入和查询负载。它是 TICK 堆栈的一个组成部分。InfluxDB 旨在用作涉及大量时间戳数据的任何用例的后备存储，包括 DevOps 监控、应用程序指标、物联网传感器数据和实时分析。&lt;/p>
&lt;p>HoraeDB 支持 &lt;a href="https://docs.influxdata.com/influxdb/v1.8/tools/api/#influxdb-1x-http-endpoints">InfluxDB v1.8&lt;/a> 写入和查询 API。&lt;/p>
&lt;blockquote>
&lt;p>注意：用户需要将以下配置添加到服务器的配置中才能尝试 InfluxDB 写入/查询。&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>[server.default_schema_config]
default_timestamp_column_name = &amp;#34;time&amp;#34;
&lt;/code>&lt;/pre>&lt;h1 id="写入">写入&lt;/h1>
&lt;pre tabindex="0">&lt;code>curl -i -XPOST &amp;#34;http://localhost:5440/influxdb/v1/write&amp;#34; --data-binary &amp;#39;
demo,tag1=t1,tag2=t2 field1=90,field2=100 1679994647000
demo,tag1=t1,tag2=t2 field1=91,field2=101 1679994648000
demo,tag1=t11,tag2=t22 field1=90,field2=100 1679994647000
demo,tag1=t11,tag2=t22 field1=91,field2=101 1679994648000
&amp;#39;
&lt;/code>&lt;/pre>&lt;p>Post 的内容采用的是 &lt;a href="https://docs.influxdata.com/influxdb/v1.8/write_protocols/line_protocol_reference/">InfluxDB line protocol&lt;/a> 格式。&lt;/p>
&lt;p>&lt;code>measurement&lt;/code> 将映射到 HoraeDB 中的一个表，在首次写入时 server 会自动进行建表(注意：创建表的 TTL 是 7d，写入超过当前周期数据会被丢弃)。&lt;/p>
&lt;p>例如，在上面插入数据时，HoraeDB 中将创建下表：&lt;/p>
&lt;pre tabindex="0">&lt;code>CREATE TABLE `demo` (
 `tsid` uint64 NOT NULL,
 `time` timestamp NOT NULL,
 `field1` double,
 `field2` double,
 `tag1` string TAG,
 `tag2` string TAG,
 PRIMARY KEY (tsid, time),
 timestamp KEY (time))
&lt;/code>&lt;/pre>&lt;h2 id="注意事项">注意事项&lt;/h2>
&lt;ul>
&lt;li>InfluxDB 在写入时，时间戳精度默认是纳秒，HoraeDB 只支持毫秒级时间戳，用户可以通过 &lt;code>precision&lt;/code> 参数指定数据精度，HoraeDB 内部会自动转成毫秒精度。&lt;/li>
&lt;li>暂时不支持诸如 &lt;code>db&lt;/code> 等查询参数&lt;/li>
&lt;/ul>
&lt;h1 id="查询">查询&lt;/h1>
&lt;div class="highlight">&lt;div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span> curl -G &lt;span style="color:#ba2121">&amp;#39;http://localhost:5440/influxdb/v1/query&amp;#39;&lt;/span> --data-urlencode &lt;span style="color:#ba2121">&amp;#39;q=SELECT * FROM &amp;#34;demo&amp;#34;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查询结果和 InfluxDB 查询接口一致：&lt;/p></description></item><item><title>OpenTSDB</title><link>https://horaedb.apache.org/cn/docs/user-guide/ecosystem/opentsdb/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://horaedb.apache.org/cn/docs/user-guide/ecosystem/opentsdb/</guid><description>&lt;p>&lt;a href="http://opentsdb.net/">OpenTSDB&lt;/a> 是基于 HBase 的分布式、可伸缩的时间序列数据库。&lt;/p>
&lt;h1 id="写入">写入&lt;/h1>
&lt;p>HoraeDB 遵循 &lt;a href="http://opentsdb.net/docs/build/html/api_http/put.html">OpenTSDB put&lt;/a> 写入接口。&lt;/p>
&lt;p>&lt;code>summary&lt;/code> 和 &lt;code>detailed&lt;/code> 还未支持。&lt;/p>
&lt;pre tabindex="0">&lt;code>curl --location &amp;#39;http://localhost:5440/opentsdb/api/put&amp;#39; \
--header &amp;#39;Content-Type: application/json&amp;#39; \
-d &amp;#39;[{
 &amp;#34;metric&amp;#34;: &amp;#34;sys.cpu.nice&amp;#34;,
 &amp;#34;timestamp&amp;#34;: 1692588459000,
 &amp;#34;value&amp;#34;: 18,
 &amp;#34;tags&amp;#34;: {
 &amp;#34;host&amp;#34;: &amp;#34;web01&amp;#34;,
 &amp;#34;dc&amp;#34;: &amp;#34;lga&amp;#34;
 }
},
{
 &amp;#34;metric&amp;#34;: &amp;#34;sys.cpu.nice&amp;#34;,
 &amp;#34;timestamp&amp;#34;: 1692588459000,
 &amp;#34;value&amp;#34;: 18,
 &amp;#34;tags&amp;#34;: {
 &amp;#34;host&amp;#34;: &amp;#34;web01&amp;#34;
 }
}]&amp;#39;
&lt;/code>&lt;/pre>&lt;p>&lt;code>metric&lt;/code> 将映射到 HoraeDB 中的一个表，在首次写入时 server 会自动进行建表(注意：创建表的 TTL 是 7d，写入超过当前周期数据会被丢弃)。&lt;/p>
&lt;p>例如，在上面插入数据时，HoraeDB 中将创建下表：&lt;/p>
&lt;pre tabindex="0">&lt;code>CREATE TABLE `sys.cpu.nice`(
 `tsid` uint64 NOT NULL,
 `timestamp` timestamp NOT NULL,
 `dc` string TAG,
 `host` string TAG,
 `value` bigint,
 PRIMARY KEY(tsid, timestamp),
 TIMESTAMP KEY(timestamp))
 ENGINE = Analytic
 WITH(arena_block_size = &amp;#39;2097152&amp;#39;, compaction_strategy = &amp;#39;default&amp;#39;,
 compression = &amp;#39;ZSTD&amp;#39;, enable_ttl = &amp;#39;true&amp;#39;, num_rows_per_row_group = &amp;#39;8192&amp;#39;,
 segment_duration = &amp;#39;2h&amp;#39;, storage_format = &amp;#39;AUTO&amp;#39;, ttl = &amp;#39;7d&amp;#39;,
 update_mode = &amp;#39;OVERWRITE&amp;#39;, write_buffer_size = &amp;#39;33554432&amp;#39;)
&lt;/code>&lt;/pre>&lt;h1 id="查询">查询&lt;/h1>
&lt;p>暂不支持 OpenTSDB 查询，&lt;a href="https://github.com/apache/incubator-horaedb/issues/904">tracking issue&lt;/a>。&lt;/p></description></item><item><title>Prometheus</title><link>https://horaedb.apache.org/cn/docs/user-guide/ecosystem/prometheus/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://horaedb.apache.org/cn/docs/user-guide/ecosystem/prometheus/</guid><description>&lt;p>&lt;a href="https://prometheus.io/">Prometheus&lt;/a>是一个流行的云原生监控工具，由于其可扩展性、可靠性和可伸缩性，被企业广泛采用。它用于从云原生服务（如 Kubernetes 和 OpenShift）中获取指标，并将其存储在时序数据库中。Prometheus 也很容易扩展，允许用户用其他数据库扩展其特性和功能。&lt;/p>
&lt;p>HoraeDB 可以作为 Prometheus 的长期存储解决方案，同时支持远程读取和远程写入 API。&lt;/p>
&lt;h2 id="配置">配置&lt;/h2>
&lt;p>你可以通过在&lt;code>prometheus.yml&lt;/code>中添加以下几行来配置 Prometheus 使用 HoraeDB 作为一个远程存储：&lt;/p>
&lt;div class="highlight">&lt;div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#008000;font-weight:bold">remote_write&lt;/span>:&lt;span style="color:#bbb">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#bbb"> &lt;/span>- &lt;span style="color:#008000;font-weight:bold">url&lt;/span>:&lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#ba2121">&amp;#34;http://&amp;lt;address&amp;gt;:&amp;lt;http_port&amp;gt;/prom/v1/write&amp;#34;&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#bbb">&lt;/span>&lt;span style="color:#008000;font-weight:bold">remote_read&lt;/span>:&lt;span style="color:#bbb">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#bbb"> &lt;/span>- &lt;span style="color:#008000;font-weight:bold">url&lt;/span>:&lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#ba2121">&amp;#34;http://&amp;lt;address&amp;gt;:&amp;lt;http_port&amp;gt;/prom/v1/read&amp;#34;&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>每一个指标都会对应一个 HoraeDB 中的表：&lt;/p>
&lt;ul>
&lt;li>标签（labels）对应字符串类型的 &lt;code>tag&lt;/code> 列&lt;/li>
&lt;li>数据的时间戳对应一个 timestamp 类型的 &lt;code>timestmap&lt;/code> 列&lt;/li>
&lt;li>数据的值对应一个双精度浮点数类型的 &lt;code>value&lt;/code> 列&lt;/li>
&lt;/ul>
&lt;p>比如有如下 Prometheus 指标：&lt;/p>
&lt;pre tabindex="0">&lt;code>up{env=&amp;#34;dev&amp;#34;, instance=&amp;#34;127.0.0.1:9090&amp;#34;, job=&amp;#34;prometheus-server&amp;#34;}
&lt;/code>&lt;/pre>&lt;p>对应 HoraeDB 中如下的表(注意：创建表的 TTL 是 7d，写入超过当前周期数据会被丢弃)：&lt;/p>
&lt;pre tabindex="0">&lt;code>CREATE TABLE `up` (
 `timestamp` timestamp NOT NULL,
 `tsid` uint64 NOT NULL,
 `env` string TAG,
 `instance` string TAG,
 `job` string TAG,
 `value` double,
 PRIMARY KEY (tsid, timestamp),
 timestamp KEY (timestamp)
);

SELECT * FROM up;
&lt;/code>&lt;/pre>&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th style="text-align: center">tsid&lt;/th>
 &lt;th style="text-align: center">timestamp&lt;/th>
 &lt;th style="text-align: center">env&lt;/th>
 &lt;th style="text-align: center">instance&lt;/th>
 &lt;th style="text-align: center">job&lt;/th>
 &lt;th style="text-align: center">value&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td style="text-align: center">12683162471309663278&lt;/td>
 &lt;td style="text-align: center">1675824740880&lt;/td>
 &lt;td style="text-align: center">dev&lt;/td>
 &lt;td style="text-align: center">127.0.0.1:9090&lt;/td>
 &lt;td style="text-align: center">prometheus-server&lt;/td>
 &lt;td style="text-align: center">1&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table></description></item></channel></rss>