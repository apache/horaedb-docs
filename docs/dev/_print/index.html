<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://horaedb.apache.org/docs/dev/><link rel=alternate type=application/rss+xml href=https://horaedb.apache.org/docs/dev/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Development | Apache HoraeDB</title>
<meta name=description content="A high-performance, distributed, cloud native time-series database."><meta property="og:url" content="https://horaedb.apache.org/docs/dev/"><meta property="og:site_name" content="Apache HoraeDB"><meta property="og:title" content="Development"><meta property="og:description" content="A high-performance, distributed, cloud native time-series database."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Development"><meta itemprop=description content="A high-performance, distributed, cloud native time-series database."><meta itemprop=dateModified content="2024-08-21T10:34:40+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Development"><meta name=twitter:description content="A high-performance, distributed, cloud native time-series database."><link rel=preload href=/scss/main.min.5e43f8574351718e9b44966c9f3a571202ed048c082f457fb574c10b1a1bc56c.css as=style integrity="sha256-XkP4V0NRcY6bRJZsnzpXEgLtBIwIL0V/tXTBCxobxWw=" crossorigin=anonymous><link href=/scss/main.min.5e43f8574351718e9b44966c9f3a571202ed048c082f457fb574c10b1a1bc56c.css rel=stylesheet integrity="sha256-XkP4V0NRcY6bRJZsnzpXEgLtBIwIL0V/tXTBCxobxWw=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Apache HoraeDB</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class="nav-link active" href=/docs/><i class='fa-solid fa-book'></i><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/blog/><i class='fa-brands fa-blogger'></i><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/downloads/><i class='fa-solid fa-download'></i><span>Downloads</span></a></li><li class=nav-item><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/cn/docs/dev/>中文</a></li></ul></div></li><li class="td-light-dark-menu nav-item dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)"><svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.ac4e18edf67e184de782ba34f2619be1.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/dev/>Return to the regular view of this page</a>.</p></div><h1 class=title>Development</h1><ul><li>1: <a href=#pg-efe75bc5164c17b0dd3f809d1b6dce17>Supported Platform</a></li><li>2: <a href=#pg-d093397cbed5d3c7c71c2c5a3d990c59>Conventional Commit Guide</a></li><li>3: <a href=#pg-b43b85bf4c5d805b655422565c67aaee>Compile</a></li><li>4: <a href=#pg-aa0192c7ef282112fff2d5b9ef838169>Profiling</a></li><li>5: <a href=#pg-1248c0925cc367a4f87de9dac846b46d>Rationale and Goals</a></li><li>6: <a href=#pg-998d0585ca29638d7ea6bebdd5056382>RoadMap</a></li><li>7: <a href=#pg-040fc3aac83bad085ea6f9dab4c775ce>SDK Development</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-efe75bc5164c17b0dd3f809d1b6dce17>1 - Supported Platform</h1><p>作为一个开源的数据库，HoraeDB 可以部署在基于英特尔 /ARM 架构的服务器，以及常见的虚拟环境。</p><table><thead><tr><th style=text-align:center>OS</th><th style=text-align:center>status</th></tr></thead><tbody><tr><td style=text-align:center>Ubuntu LTS 16.06 or later</td><td style=text-align:center>✅</td></tr><tr><td style=text-align:center>CentOS 7.3 or later</td><td style=text-align:center>✅</td></tr><tr><td style=text-align:center>Red Hat Enterprise Linux 7.3 or later 7.x releases</td><td style=text-align:center>✅</td></tr><tr><td style=text-align:center>macOS 11 or later</td><td style=text-align:center>✅</td></tr><tr><td style=text-align:center>Windows</td><td style=text-align:center>❌</td></tr></tbody></table><ul><li>生产环境下 , Linux 是首选平台。</li><li>macOS 主要用在开发环境。</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d093397cbed5d3c7c71c2c5a3d990c59>2 - Conventional Commit Guide</h1><p>This document describes how we use <a href=https://www.conventionalcommits.org/en/v1.0.0/>conventional commit</a> in our development.</p><h1 id=structure>Structure</h1><p>We would like to structure our commit message like this:</p><pre tabindex=0><code>&lt;type&gt;[optional scope]: &lt;description&gt;
</code></pre><p>There are three parts. <code>type</code> is used to classify which kind of work this commit does. <code>scope</code> is an optional field that provides additional contextual information. And the last field is your <code>description</code> of this commit.</p><h1 id=type>Type</h1><p>Here we list some common <code>type</code>s and their meanings.</p><ul><li><code>feat</code>: Implement a new feature.</li><li><code>fix</code>: Patch a bug.</li><li><code>docs</code>: Add document or comment.</li><li><code>build</code>: Change the build script or configuration.</li><li><code>style</code>: Style change (only). No logic involved.</li><li><code>refactor</code>: Refactor an existing module for performance, structure, or other reasons.</li><li><code>test</code>: Enhance test coverage or sqlness.</li><li><code>chore</code>: None of the above.</li></ul><h1 id=scope>Scope</h1><p>The <code>scope</code> is more flexible than <code>type</code>. And it may have different values under different <code>type</code>s.</p><p>For example, In a <code>feat</code> or <code>build</code> commit we may use the code module to define scope, like</p><pre tabindex=0><code>feat(cluster):
feat(server):

build(ci):
build(image):
</code></pre><p>And in <code>docs</code> or <code>refactor</code> commits the motivation is prefer to label the <code>scope</code>, like</p><pre tabindex=0><code>docs(comment):
docs(post):

refactor(perf):
refactor(usability):
</code></pre><p>But you don&rsquo;t need to add a scope every time. This isn&rsquo;t mandatory. It&rsquo;s just a way to help describe the commit.</p><h1 id=after-all>After all</h1><p>There are many other rules or scenarios in <a href=https://www.conventionalcommits.org/en/v1.0.0/>conventional commit</a>&rsquo;s website. We are still exploring a better and more friendly workflow. Please do let us know by <a href=https://github.com/apache/incubator-horaedb/issues/new/choose>open an issue</a> if you have any suggestions ❤️</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b43b85bf4c5d805b655422565c67aaee>3 - Compile</h1><p>In order to compile HoraeDB, some relevant dependencies(including the <code>Rust</code> toolchain) should be installed.</p><h1 id=dependencies>Dependencies</h1><h2 id=ubuntu>Ubuntu</h2><p>Assuming the development environment is Ubuntu20.04, execute the following command to install the required dependencies:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install git curl gcc g++ libssl-dev pkg-config protobuf-compiler
</span></span></code></pre></td></tr></table></div></div><h2 id=macos>macOS</h2><p>If the development environment is MacOS, execute the following command to install the required dependencies.</p><ol><li>Install command line tools:</li></ol><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>xcode-select --install
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>Install protobuf:</li></ol><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>brew install protobuf
</span></span></code></pre></td></tr></table></div></div><h1 id=rust>Rust</h1><p><code>Rust</code> can be installed by <a href=https://rustup.rs/>rustup</a>. After installing rustup, when entering the HoraeDB project, the specified <code>Rust</code> version will be automatically downloaded according to the rust-toolchain file.</p><p>After execution, you need to add environment variables to use the <code>Rust</code> toolchain. Basically, just put the following commands into your <code>~/.bashrc</code> or <code>~/.bash_profile</code>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:green>source</span> <span style=color:#19177c>$HOME</span>/.cargo/env
</span></span></code></pre></td></tr></table></div></div><h1 id=compile-and-run>Compile and Run</h1><h2 id=horaedb-server>horaedb-server</h2><p>Compile horaedb-server by the following command in project root directory:</p><pre tabindex=0><code>cargo build
</code></pre><p>Then you can run it using the default configuration file provided in the codebase.</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./target/debug/horaedb-server --config ./docs/minimal.toml
</span></span></code></pre></td></tr></table></div></div><h1 id=tips>Tips</h1><p>When compiling on macOS, you may encounter following errors:</p><pre tabindex=0><code>IO error: while open a file for lock: /var/folders/jx/grdtrdms0zl3hy6zp251vjh80000gn/T/.tmpmFOAF9/manifest/LOCK: Too many open files

or

error: could not compile `regex-syntax` (lib)
warning: build failed, waiting for other jobs to finish...
LLVM ERROR: IO failure on output stream: File too large
error: could not compile `syn` (lib)
</code></pre><p>To fix those, you should adjust ulimit as follows:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:green>ulimit</span> -n unlimited
</span></span><span style=display:flex><span><span style=color:green>ulimit</span> -f unlimited
</span></span></code></pre></td></tr></table></div></div><h2 id=horaemeta-server>horaemeta-server</h2><p>Building horaemeta-server require Golang version >= 1.21, please <a href=https://go.dev/doc/install>install it</a> before compile.</p><p>Then in <code>horaemeta</code> directory, execute:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go build -o bin/horaemeta-server ./cmd/horaemeta-server/main.go
</span></span></code></pre></td></tr></table></div></div><p>Then you can run horaemeta-server like this:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/horaemeta-server
</span></span></code></pre></td></tr></table></div></div></div><div class=td-content style=page-break-before:always><h1 id=pg-aa0192c7ef282112fff2d5b9ef838169>4 - Profiling</h1><h3 id=cpu-profiling>CPU profiling</h3><p>HoraeDB provides cpu profiling http api <code>debug/profile/cpu</code>.</p><p>Example:</p><pre tabindex=0><code>// 60s cpu sampling data
curl 0:5000/debug/profile/cpu/60

// Output file path.
/tmp/flamegraph_cpu.svg
</code></pre><h3 id=heap-profiling>Heap profiling</h3><p>HoraeDB provides heap profiling http api <code>debug/profile/heap</code>.</p><h3 id=install-dependencies>Install dependencies</h3><pre tabindex=0><code>sudo yum install -y jemalloc-devel ghostscript graphviz
</code></pre><p>Example:</p><pre tabindex=0><code>// enable malloc prof
export MALLOC_CONF=prof:true

// run horaedb-server
./horaedb-server ....

// 60s cpu sampling data
curl -L &#39;0:5000/debug/profile/heap/60&#39; &gt; /tmp/heap_profile
jeprof --show_bytes --pdf /usr/bin/horaedb-server /tmp/heap_profile &gt; profile_heap.pdf

jeprof --show_bytes --svg /usr/bin/horaedb-server /tmp/heap_profile &gt; profile_heap.svg
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-1248c0925cc367a4f87de9dac846b46d>5 - Rationale and Goals</h1><p>As every Rust programmer knows, the language has many powerful features, and there are often
several patterns which can express the same idea. Also, as every professional programmer comes to
discover, code is almost always read far more than it is written.</p><p>Thus, we choose to use a consistent set of idioms throughout our code so that it is easier to read
and understand for both existing and new contributors.</p><h2 id=unsafe-and-platform-dependent-conditional-compilation>Unsafe and Platform-Dependent conditional compilation</h2><h3 id=avoid-unsafe-rust>Avoid <code>unsafe</code> Rust</h3><p>One of the main reasons to use Rust as an implementation language is its strong memory safety
guarantees; Almost all of these guarantees are voided by the use of <code>unsafe</code>. Thus, unless there is
an excellent reason and the use is discussed beforehand, it is unlikely HoraeDB will accept patches
with <code>unsafe</code> code.</p><p>We may consider taking unsafe code given:</p><ul><li>performance benchmarks showing a <em>very</em> compelling improvement</li><li>a compelling explanation of why the same performance can not be achieved using <code>safe</code> code</li><li>tests showing how it works safely across threads</li></ul><h3 id=avoid-platform-specific-conditional-compilation-cfg>Avoid platform-specific conditional compilation <code>cfg</code></h3><p>We hope that HoraeDB is usable across many different platforms and Operating systems, which means we
put a high value on standard Rust.</p><p>While some performance critical code may require architecture specific instructions, (e.g.
<code>AVX512</code>) most of the code should not.</p><h2 id=errors>Errors</h2><h3 id=all-errors-should-follow-the-snafu-crate-philosophyhttpsdocsrssnafu0610snafuguidephilosophyindexhtml-and-use-snafu-functionality>All errors should follow the <a href=https://docs.rs/snafu/0.6.10/snafu/guide/philosophy/index.html>SNAFU crate philosophy</a> and use SNAFU functionality</h3><p><em>Good</em>:</p><ul><li>Derives <code>Snafu</code> and <code>Debug</code> functionality</li><li>Has a useful, end-user-friendly display message</li></ul><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#bc7a00>#[derive(Snafu, Debug)]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(r#</span><span style=color:#ba2121>&#34;Conversion needs at least one line of data&#34;</span><span style=color:#bc7a00>#))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>NeedsAtLeastOneLine,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#408080;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>NeedsAtLeastOneLine,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#408080;font-style:italic>// ...
</span></span></span></code></pre></td></tr></table></div></div><h3 id=use-the-ensure-macro-to-check-a-condition-and-return-an-error>Use the <code>ensure!</code> macro to check a condition and return an error</h3><p><em>Good</em>:</p><ul><li>Reads more like an <code>assert!</code></li><li>Is more concise</li></ul><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>ensure!(<span style=color:#666>!</span>self.schema_sample.is_empty(),<span style=color:#bbb> </span>NeedsAtLeastOneLine);<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>if</span><span style=color:#bbb> </span>self.schema_sample.is_empty()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:green>Err</span>(Error::NeedsAtLeastOneLine<span style=color:#bbb> </span>{});<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=errors-should-be-defined-in-the-module-they-are-instantiated>Errors should be defined in the module they are instantiated</h3><p><em>Good</em>:</p><ul><li>Groups related error conditions together most closely with the code that produces them</li><li>Reduces the need to <code>match</code> on unrelated errors that would never happen</li></ul><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#bc7a00>#[derive(Debug, Snafu)]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(</span><span style=color:#ba2121>&#34;Not implemented: {}&#34;</span><span style=color:#bc7a00>, operation_name))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>NotImplemented<span style=color:#bbb> </span>{<span style=color:#bbb> </span>operation_name: <span style=color:green>String</span> }<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>ensure!(foo.is_implemented(),<span style=color:#bbb> </span>NotImplemented<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>operation_name: <span style=color:#ba2121>&#34;foo&#34;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>use</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>crate</span>::errors::NotImplemented;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>ensure!(foo.is_implemented(),<span style=color:#bbb> </span>NotImplemented<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>operation_name: <span style=color:#ba2121>&#34;foo&#34;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=the-result-type-alias-should-be-defined-in-each-module>The <code>Result</code> type alias should be defined in each module</h3><p><em>Good</em>:</p><ul><li>Reduces repetition</li></ul><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>type</span> <span style=color:green>Result</span><span style=color:#666>&lt;</span>T,<span style=color:#bbb> </span>E<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>Error<span style=color:#666>&gt;</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>std::result::<span style=color:green>Result</span><span style=color:#666>&lt;</span>T,<span style=color:#bbb> </span>E<span style=color:#666>&gt;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>..</span>.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>fn</span> <span style=color:#00f>foo</span>()<span style=color:#bbb> </span>-&gt; <span style=color:green>Result</span><span style=color:#666>&lt;</span><span style=color:#b00040>bool</span><span style=color:#666>&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb> </span><span style=color:green;font-weight:700>true</span><span style=color:#bbb> </span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#666>..</span>.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>fn</span> <span style=color:#00f>foo</span>()<span style=color:#bbb> </span>-&gt; <span style=color:green>Result</span><span style=color:#666>&lt;</span><span style=color:#b00040>bool</span>,<span style=color:#bbb> </span>Error<span style=color:#666>&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb> </span><span style=color:green;font-weight:700>true</span><span style=color:#bbb> </span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=err-variants-should-be-returned-with-fail><code>Err</code> variants should be returned with <code>fail()</code></h3><p><em>Good</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>return</span><span style=color:#bbb> </span>NotImplemented<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>operation_name: <span style=color:#ba2121>&#34;Parquet format conversion&#34;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}.fail();<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>return</span><span style=color:#bbb> </span><span style=color:green>Err</span>(Error::NotImplemented<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>operation_name: <span style=color:green>String</span>::from(<span style=color:#ba2121>&#34;Parquet format conversion&#34;</span>),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>});<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=use-context-to-wrap-underlying-errors-into-module-specific-errors>Use <code>context</code> to wrap underlying errors into module specific errors</h3><p><em>Good</em>:</p><ul><li>Reduces boilerplate</li></ul><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>input_reader<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>.read_to_string(<span style=color:#666>&amp;</span><span style=color:green;font-weight:700>mut</span><span style=color:#bbb> </span>buf)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>.context(UnableToReadInput<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>input_filename,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>})<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>input_reader<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>.read_to_string(<span style=color:#666>&amp;</span><span style=color:green;font-weight:700>mut</span><span style=color:#bbb> </span>buf)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>.map_err(<span style=color:#666>|</span>e<span style=color:#666>|</span><span style=color:#bbb> </span>Error::UnableToReadInput<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>name: <span style=color:green>String</span>::from(input_filename),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>source: <span style=color:#00f;font-weight:700>e</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>})<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Hint for <code>Box&lt;dyn::std::error::Error></code> in Snafu</em>:</p><p>If your error contains a trait object (e.g. <code>Box&lt;dyn std::error::Error + Send + Sync></code>), in order
to use <code>context()</code> you need to wrap the error in a <code>Box</code>, we provide a <code>box_err</code> function to help do this conversion:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#bc7a00>#[derive(Debug, Snafu)]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(</span><span style=color:#ba2121>&#34;gRPC planner got error listing partition keys: {}&#34;</span><span style=color:#bc7a00>, source))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>ListingPartitions<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>source: <span style=color:green>Box</span><span style=color:#666>&lt;</span><span style=color:green;font-weight:700>dyn</span><span style=color:#bbb> </span>std::error::Error<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:green>Send</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:green>Sync</span><span style=color:#666>&gt;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>},<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>..</span>.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>use</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>use</span><span style=color:#bbb> </span>common_util::error::BoxError;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#408080;font-style:italic>// Wrap error in a box prior to calling context()
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>database<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>.partition_keys()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>.<span style=color:green;font-weight:700>await</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>.box_err()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>.context(ListingPartitions)<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=each-error-cause-in-a-module-should-have-a-distinct-error-enum-variant>Each error cause in a module should have a distinct <code>Error</code> enum variant</h3><p>Specific error types are preferred over a generic error with a <code>message</code> or <code>kind</code> field.</p><p><em>Good</em>:</p><ul><li>Makes it easier to track down the offending code based on a specific failure</li><li>Reduces the size of the error enum (<code>String</code> is 3x 64-bit vs no space)</li><li>Makes it easier to remove vestigial errors</li><li>Is more concise</li></ul><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#bc7a00>#[derive(Debug, Snafu)]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(</span><span style=color:#ba2121>&#34;Error writing remaining lines {}&#34;</span><span style=color:#bc7a00>, source))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>UnableToWriteGoodLines<span style=color:#bbb> </span>{<span style=color:#bbb> </span>source: <span style=color:#00f;font-weight:700>IngestError</span><span style=color:#bbb> </span>},<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(</span><span style=color:#ba2121>&#34;Error while closing the table writer {}&#34;</span><span style=color:#bc7a00>, source))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>UnableToCloseTableWriter<span style=color:#bbb> </span>{<span style=color:#bbb> </span>source: <span style=color:#00f;font-weight:700>IngestError</span><span style=color:#bbb> </span>},<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>write_lines.context(UnableToWriteGoodLines)<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>close_writer.context(UnableToCloseTableWriter))<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(</span><span style=color:#ba2121>&#34;Error {}: {}&#34;</span><span style=color:#bc7a00>, message, source))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>WritingError<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>source: <span style=color:#00f;font-weight:700>IngestError</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>message: <span style=color:green>String</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>},<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>write_lines.context(WritingError<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>message: <span style=color:green>String</span>::from(<span style=color:#ba2121>&#34;Error while writing remaining lines&#34;</span>),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>})<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>close_writer.context(WritingError<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>message: <span style=color:green>String</span>::from(<span style=color:#ba2121>&#34;Error while closing the table writer&#34;</span>),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>})<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=leaf-error-should-contains-backtrace>Leaf error should contains backtrace</h3><p>In order to make debugging easier, leaf errors in error chain should contains a backtrace.</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#408080;font-style:italic>// Error in module A
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(</span><span style=color:#ba2121>&#34;This is a leaf error, source:{}.</span><span style=color:#b62;font-weight:700>\n</span><span style=color:#ba2121>Backtrace:</span><span style=color:#b62;font-weight:700>\n</span><span style=color:#ba2121>{}&#34;</span><span style=color:#bc7a00>, source, backtrace))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>LeafError<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>source: <span style=color:#00f;font-weight:700>ErrorFromDependency</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>backtrace: <span style=color:#00f;font-weight:700>Backtrace</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>},<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic>// Error in module B
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:green;font-weight:700>pub</span><span style=color:#bbb> </span><span style=color:green;font-weight:700>enum</span> <span style=color:#00f;font-weight:700>Error</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#bc7a00>#[snafu(display(</span><span style=color:#ba2121>&#34;Another error, source:{}.</span><span style=color:#b62;font-weight:700>\n</span><span style=color:#ba2121>Backtrace:</span><span style=color:#b62;font-weight:700>\n</span><span style=color:#ba2121>{}&#34;</span><span style=color:#bc7a00>, source, backtrace))]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>AnotherError<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#ba2121;font-style:italic>/// This error wraps another error that already has a
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic></span><span style=color:#bbb>        </span><span style=color:#ba2121;font-style:italic>/// backtrace. Instead of capturing our own, we forward the
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic></span><span style=color:#bbb>        </span><span style=color:#ba2121;font-style:italic>/// request for the backtrace to the inner error. This gives a
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic></span><span style=color:#bbb>        </span><span style=color:#ba2121;font-style:italic>/// more accurate backtrace.
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic></span><span style=color:#bbb>        </span><span style=color:#bc7a00>#[snafu(backtrace)]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>source: <span style=color:#00f;font-weight:700>crate</span>::A::Error,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>},<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=tests>Tests</h2><h3 id=dont-return-result-from-test-functions>Don&rsquo;t return <code>Result</code> from test functions</h3><p>At the time of this writing, if you return <code>Result</code> from test functions to use <code>?</code> in the test
function body and an <code>Err</code> value is returned, the test failure message is not particularly helpful.
Therefore, prefer not having a return type for test functions and instead using <code>expect</code> or
<code>unwrap</code> in test function bodies.</p><p><em>Good</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#bc7a00>#[test]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>fn</span> <span style=color:#00f>google_cloud</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>let</span><span style=color:#bbb> </span>config<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>Config::new();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>let</span><span style=color:#bbb> </span>integration<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>ObjectStore::new_google_cloud_storage(GoogleCloudStorage::new(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>config.service_account,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>config.bucket,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>));<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>put_get_delete_list(<span style=color:#666>&amp;</span>integration).unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>list_with_delimiter(<span style=color:#666>&amp;</span>integration).unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><p><em>Bad</em>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:green;font-weight:700>type</span> <span style=color:#00f;font-weight:700>TestError</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:green>Box</span><span style=color:#666>&lt;</span><span style=color:green;font-weight:700>dyn</span><span style=color:#bbb> </span>std::error::Error<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:green>Send</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:green>Sync</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:green>&#39;static</span><span style=color:#666>&gt;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>type</span> <span style=color:green>Result</span><span style=color:#666>&lt;</span>T,<span style=color:#bbb> </span>E<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>TestError<span style=color:#666>&gt;</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>std::result::<span style=color:green>Result</span><span style=color:#666>&lt;</span>T,<span style=color:#bbb> </span>E<span style=color:#666>&gt;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#bc7a00>#[test]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>fn</span> <span style=color:#00f>google_cloud</span>()<span style=color:#bbb> </span>-&gt; <span style=color:green>Result</span><span style=color:#666>&lt;</span>()<span style=color:#666>&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>let</span><span style=color:#bbb> </span>config<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>Config::new();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>let</span><span style=color:#bbb> </span>integration<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>ObjectStore::new_google_cloud_storage(GoogleCloudStorage::new(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>config.service_account,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>config.bucket,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>));<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>put_get_delete_list(<span style=color:#666>&amp;</span>integration)<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>list_with_delimiter(<span style=color:#666>&amp;</span>integration)<span style=color:#666>?</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green>Ok</span>(())<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=thanks>Thanks</h2><p>Initial version of this doc is forked from <a href=https://github.com/influxdata/influxdb_iox/blob/main/docs/style_guide.md>influxdb_iox</a>, thanks for their hard work.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-998d0585ca29638d7ea6bebdd5056382>6 - RoadMap</h1><h3 id=v010>v0.1.0</h3><ul><li><input checked disabled type=checkbox> Standalone version, local storage</li><li><input checked disabled type=checkbox> Analytical storage format</li><li><input checked disabled type=checkbox> Support SQL</li></ul><h3 id=v020>v0.2.0</h3><ul><li><input checked disabled type=checkbox> Distributed version supports static topology defined in config file.</li><li><input checked disabled type=checkbox> The underlying storage supports Aliyun OSS.</li><li><input checked disabled type=checkbox> WAL implementation based on <a href=https://github.com/oceanbase/oceanbase>OBKV</a>.</li></ul><h3 id=v030>v0.3.0</h3><ul><li><input checked disabled type=checkbox> Release multi-language clients, including Java, Rust and Python.</li><li><input checked disabled type=checkbox> Static cluster mode with <code>HoraeMeta</code>.</li><li><input checked disabled type=checkbox> Basic implementation of hybrid storage format.</li></ul><h3 id=v040>v0.4.0</h3><ul><li><input checked disabled type=checkbox> Implement more sophisticated cluster solution that enhances reliability and scalability of HoraeDB.</li><li><input checked disabled type=checkbox> Set up nightly benchmark with TSBS.</li></ul><h3 id=v100-alpha-released>v1.0.0-alpha (Released)</h3><ul><li><input checked disabled type=checkbox> Implement Distributed WAL based on <code>Apache Kafka</code>.</li><li><input checked disabled type=checkbox> Release Golang client.</li><li><input checked disabled type=checkbox> Improve the query performance for classic time series workloads.</li><li><input checked disabled type=checkbox> Support dynamic migration of tables in cluster mode.</li></ul><h3 id=v100>v1.0.0</h3><ul><li><input checked disabled type=checkbox> Formally release HoraeDB and its SDKs with all breaking changes finished.</li><li><input checked disabled type=checkbox> Finish the majority of work related to <code>Table Partitioning</code>.</li><li><input checked disabled type=checkbox> Various efforts to improve query performance, especially for cloud-native cluster mode. These works include:<ul><li>Multi-tier cache.</li><li>Introduce various methods to reduce the data fetched from remote storage (improve the accuracy of SST data filtering).</li><li>Increase the parallelism while fetching data from remote object-store.</li></ul></li><li><input checked disabled type=checkbox> Improve data ingestion performance by introducing resource control over compaction.</li></ul><h3 id=afterwards>Afterwards</h3><p>With an in-depth understanding of the time-series database and its various use cases, the majority of our work will focus on performance, reliability, scalability, ease of use, and collaborations with open-source communities.</p><ul><li><input disabled type=checkbox> Add utilities that support <code>PromQL</code>, <code>InfluxQL</code>, <code>OpenTSDB</code> protocol, and so on.</li><li><input disabled type=checkbox> Provide basic utilities for operation and maintenance. Specifically, the following are included:<ul><li>Deployment tools that fit well for cloud infrastructures like <code>Kubernetes</code>.</li><li>Enhance self-observability, especially critical logs and metrics should be supplemented.</li></ul></li><li><input disabled type=checkbox> Develop various tools that ease the use of HoraeDB. For example, data import and export tools.</li><li><input disabled type=checkbox> Explore new storage formats that will improve performance on hybrid workloads (analytical and time-series workloads).</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-040fc3aac83bad085ea6f9dab4c775ce>7 - SDK Development</h1><h2 id=rust>Rust</h2><p><a href=https://github.com/apache/horaedb-client-rs>https://github.com/apache/horaedb-client-rs</a></p><p>First install cargo with</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl https://sh.rustup.rs -sSf | sh
</span></span></code></pre></td></tr></table></div></div><p>Then build with</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cargo build
</span></span></code></pre></td></tr></table></div></div><h2 id=python>Python</h2><p><a href=https://github.com/apache/horaedb-client-py>https://github.com/apache/horaedb-client-py</a></p><h3 id=requirements>Requirements</h3><ul><li>python 3.7+</li></ul><p>The Python SDK rely on Rust SDK, so <a href=https://doc.rust-lang.org/stable/cargo/getting-started/installation.html>cargo</a> is also required, then install build tool <a href=https://github.com/PyO3/maturin>maturin</a>:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install maturin
</span></span></code></pre></td></tr></table></div></div><p>Then build Python SDK with this:</p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>maturin build
</span></span></code></pre></td></tr></table></div></div><h2 id=go>Go</h2><p><a href=https://github.com/apache/horaedb-client-go>https://github.com/apache/horaedb-client-go</a></p><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go build ./...
</span></span></code></pre></td></tr></table></div></div><h2 id=java>Java</h2><p><a href=https://github.com/apache/horaedb-client-java>https://github.com/apache/horaedb-client-java</a></p><h3 id=requirements-1>Requirements</h3><ul><li>java 1.8</li><li>maven 3.6.3+</li></ul><div class=highlight><div style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mvn clean install -DskipTests<span style=color:#666>=</span><span style=color:green>true</span> -Dmaven.javadoc.skip<span style=color:#666>=</span><span style=color:green>true</span> -B -V
</span></span></code></pre></td></tr></table></div></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class=td-footer__center>Apache HoraeDB is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.<hr><span class=td-footer__copyright>&copy;
2023&ndash;2024
<span class=td-footer__authors><p>The Apache Software Foundation, Licensed under the Apache License, Version 2.0.</p><p>Apache, the names of Apache projects, and the feather logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.</p></span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div><hr><div class="row mx-md-2"><div class=td-footer__center><span class=td-footer__copyright>Found a bug in website? <a href=https://github.com/apache/horaedb-docs/issues/new>Open an issue</a> or <a href=https://github.com/apache/horaedb-docs/pulls>submit a pull request</a> on GitHub.</span></div></div><hr></div></footer></div><script src=/js/main.min.f72d00502781aaf278a14088eb2356b1ba2a05ad698a0c43fe86314d74ceab56.js integrity="sha256-9y0AUCeBqvJ4oUCI6yNWsboqBa1pigxD/oYxTXTOq1Y=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>